# Reproducible Research: Peer Assessment 1
Loading a few libraries:
```{r,echo = TRUE}
library(plyr)
library(dplyr)
library(ggplot2)
library(data.table)
```

## Loading and preprocessing the data
Load the **activity.csv** file and convert the dates to Date class:
```{r, echo = TRUE}
activityDataset <- read.csv(file = "activity.csv", header = TRUE, sep = ",")
activityDataset$date <- as.Date(activityDataset$date, "%Y-%m-%d")
```

## What is mean total number of steps taken per day?
1. Calculate the sum aggregation of steps taken by day, ignoring NAs
2. Plot the histogram based on the previous aggregation
3. Calculate and report the mean and median of the total number of steps taken per day. In this part, the aggregation was reprocessed with NAs so they are discarded inside mean() and median() functions.
```{r, echo=TRUE}
totalStepsPerDay <- with(activityDataset, aggregate(steps, by = list(date), sum, na.rm=TRUE))
plot(totalStepsPerDay, type="h", main="Histogram of steps taken each day", xlab="Dates (October to November 2012)", ylab="Number of steps", lwd=4, col="green")
totalStepsPerDay <- with(activityDataset, aggregate(steps, by = list(date), sum))
mean(totalStepsPerDay$x, na.rm=TRUE)
median(totalStepsPerDay$x, na.rm=TRUE)
```


## What is the average daily activity pattern?
1. Aggregate the total steps taken by 5 minute interval.
2. Plot the time series plot
3. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

Performs the mean aggregation given 5-minute interval
```{r, echo=TRUE}
avgTotalStepsPerInterval <- with(activityDataset, aggregate(steps, by = list(interval), mean, na.rm=TRUE))
plot(avgTotalStepsPerInterval, type="l", main="Average Steps Taken at 5 minute Intervals", xlab="Time Intervals (5-minute)", ylab="Mean number of steps taken (all Days)", col="blue")
```

Finds out which interval has the maximum average value
```{r, echo=TRUE}
maxAvgIndex <- which.max(avgTotalStepsPerInterval$x)
avgTotalStepsPerInterval[maxAvgIndex,]$Group.1
```

## Imputing missing values
1. Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with 𝙽𝙰s)
2. Devise a strategy for filling in all of the missing values in the dataset.
3. Create a new dataset that is equal to the original dataset but with the missing data filled
4. Make a histogram of the total number of steps taken each day and Calculate and report the mean and median total number of steps taken per day.

Calculate and report the total number of NA values:
```{r, echo=TRUE}
missingValsQty <- sum(is.na(activityDataset))
missingValsQty
```

Devise a strategy for filling in all of the missing values in the dataset.
```{r, echo=TRUE}
missingValueIndices <- which(is.na(activityDataset))
for(i in missingValueIndices) {
    activityDataset$steps[i] = avgTotalStepsPerInterval[avgTotalStepsPerInterval$Group.1 == activityDataset[i, 3], 2]
}
sum(is.na(activityDataset))
totalStepsPerDay <- with(activityDataset, aggregate(steps, by = list(date), sum, na.rm=TRUE))
plot(totalStepsPerDay, type="h", main="Histogram of steps taken each day", xlab="Dates (October to November 2012)", ylab="Number of steps", lwd=4, col="red")
```

## Are there differences in activity patterns between weekdays and weekends?
